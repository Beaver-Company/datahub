<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; DH_Doc 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="DH_Doc 0.1 documentation" href="index.html" />
    <link rel="next" title="Managing and Testing" href="Managing and Testing.html" />
    <link rel="prev" title="Welcome to DataHub’s documentation!" href="index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
    <h1> Generated by Sphinx </h1>
    
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="quickstart-with-vagrant">
<h2>Quickstart with Vagrant<a class="headerlink" href="#quickstart-with-vagrant" title="Permalink to this headline">¶</a></h2>
<p>Vagrant is the recommend method for developing with DataHub. It provides a VM matching the DataHub production server, regardless of your host operating system.</p>
<p>If you would prefer to install DataHub manually, see <a class="reference internal" href="#manual-installation">Manual Installation</a> below.</p>
<ol class="arabic">
<li><p class="first">Install VirtualBox <a class="reference external" href="https://www.virtualbox.org/">https://www.virtualbox.org/</a>.</p>
</li>
<li><p class="first">Install Vagrant <a class="reference external" href="https://www.vagrantup.com/downloads.html">https://www.vagrantup.com/downloads.html</a>.</p>
</li>
<li><dl class="first docutils">
<dt>Clone DataHub:</dt>
<dd><div class="first last highlight-bash"><div class="highlight"><pre><span></span>$ git clone https://github.com/datahuborg/datahub.git
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Add this line to your hosts file (/etc/hosts on most systems):</dt>
<dd><div class="first last highlight-bash"><div class="highlight"><pre><span></span>192.168.50.4    datahub-local.mit.edu
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>From your clone, start the VM:</dt>
<dd><div class="first last highlight-bash"><div class="highlight"><pre><span></span>$ vagrant up
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<p>This last step might take several minutes depending on your connection and computer.</p>
<p>Once <code class="docutils literal"><span class="pre">vagrant</span> <span class="pre">up</span></code> finishes, you can see your environment running at <a class="reference external" href="http://datahub-local.mit.edu">http://datahub-local.mit.edu</a>.</p>
<p>If you see a <code class="docutils literal"><span class="pre">Datahub</span> <span class="pre">module</span> <span class="pre">not</span> <span class="pre">found</span></code> error, this is due to an unresolved issue with thrift code not compiling only after the first <code class="docutils literal"><span class="pre">vagrant</span> <span class="pre">up</span></code>. Please see this thread for a resolution: <a class="reference external" href="https://github.com/datahuborg/datahub/issues/119">https://github.com/datahuborg/datahub/issues/119</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Vagrant keeps your working copy and the VM in sync, so edits you make to DataHub&#8217;s code will be reflected on datahub-local.mit.edu. Changes to static files like CSS, JS, and documentation must be collected before the server will notice them. For more information, see management commands below.</p>
</div>
<div class="section" id="using-non-standard-ports">
<h3>Using non-standard ports<a class="headerlink" href="#using-non-standard-ports" title="Permalink to this headline">¶</a></h3>
<p>If your host environment does not allow use of ports 80 and 443, it is possible to use DataHub on forwarded ports but some extra configuration is required.</p>
<ol class="arabic">
<li><dl class="first docutils">
<dt>Edit the Vagrantfile to expose ports 80 and/or 443 on usable ports.</dt>
<dd><div class="first last highlight-ruby"><div class="highlight"><pre><span></span><span class="no">Vagrant</span><span class="o">.</span><span class="n">configure</span><span class="p">(</span><span class="no">VAGRANTFILE_API_VERSION</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
  <span class="o">...</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">18080</span>
  <span class="n">config</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">network</span> <span class="s2">&quot;forwarded_port&quot;</span><span class="p">,</span> <span class="ss">guest</span><span class="p">:</span> <span class="mi">443</span><span class="p">,</span> <span class="ss">host</span><span class="p">:</span> <span class="mi">18081</span>
  <span class="o">...</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Edit the nginx configuration file at provisions/nginx/default.conf to make the reverse proxy aware of what the new ports are.</dt>
<dd><div class="first last highlight-nginx"><div class="highlight"><pre><span></span># Uncomment and customize:
map $scheme $port_to_forward {
    default 18080;
    https   18081;
}
...
location / {
    ...
    # Uncomment:
    proxy_set_header X-Forwarded-Host $host:$port_to_forward;
    proxy_set_header X-Forwarded-Server $server_name;
    proxy_set_header X-Forwarded-Port $port_to_forward;
    ...
}
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Edit the Django settings file at src/config/settings.py to make Django look for those headers.</dt>
<dd><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Uncomment and set to True:</span>
<span class="n">USE_X_FORWARDED_HOST</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><p class="first">From the host, run <code class="docutils literal"><span class="pre">vagrant</span> <span class="pre">reload</span></code> to bring up the VM with your custom ports forwarded.</p>
<p>If you don&#8217;t mind losing all of your existing DataHub data, running <code class="docutils literal"><span class="pre">vagrant</span> <span class="pre">destroy</span> <span class="pre">-f</span> <span class="pre">&amp;&amp;</span> <span class="pre">vagrant</span> <span class="pre">up</span></code> instead will rebuild the entire site using your new custom config. If you want to keep your existing VM&#8217;s data, follow step 5 below.</p>
</li>
<li><dl class="first docutils">
<dt>Inside the VM, run:</dt>
<dd><div class="first last highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /vagrant
$ sudo sh provisions/docker/build-images.sh
$ sudo docker rm -f web
$ sudo docker create --name web <span class="se">\</span>
       --volumes-from logs <span class="se">\</span>
       --volumes-from app <span class="se">\</span>
       -v /ssl/:/etc/nginx/ssl/ <span class="se">\</span>
       --net<span class="o">=</span>datahub_dev <span class="se">\</span>
       -p 80:80 -p 443:443 <span class="se">\</span>
       datahuborg/nginx
$ sudo docker start web
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<p>At the end of these steps, DataHub should be reachable at <a class="reference external" href="http://localhost:18080">http://localhost:18080</a> and <a class="reference external" href="https://localhost:18081">https://localhost:18081</a>.</p>
</div>
</div>
<div class="section" id="manual-installation">
<h2>Manual Installation<a class="headerlink" href="#manual-installation" title="Permalink to this headline">¶</a></h2>
<p>Follow these steps if you would prefer to forgo Vagrant and install DataHub locally.
Please note that other sections of the documentation assume that you are using the Vagrant (quickstart) setup.</p>
<div class="section" id="clone-the-repo">
<h3>Clone the repo<a class="headerlink" href="#clone-the-repo" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Make sure to clone the repo,
<code class="docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/datahuborg/datahub.git</span></code></li>
<li>Navigate into the the repo, <code class="docutils literal"><span class="pre">cd</span> <span class="pre">datahub</span></code></li>
</ol>
</div>
<div class="section" id="postgresql">
<h3>PostgreSQL<a class="headerlink" href="#postgresql" title="Permalink to this headline">¶</a></h3>
<p>DataHub is built on the <a class="reference external" href="http://www.postgresql.org/">PostgreSQL</a>
database.</p>
<ol class="arabic simple">
<li><a class="reference external" href="http://www.postgresql.org/download/">Install Postgres</a> and create a user called <code class="docutils literal"><span class="pre">postgres</span></code>. See
<a class="reference external" href="https://wiki.postgresql.org/wiki/First_steps">here</a> for
step-by-step instructions.</li>
<li>When the Postgres server is running, open the Postgres shell
<code class="docutils literal"><span class="pre">psql</span> <span class="pre">-U</span> <span class="pre">postgres</span></code></li>
<li>Create a database for DataHub, <code class="docutils literal"><span class="pre">CREATE</span> <span class="pre">DATABASE</span> <span class="pre">datahub;</span></code></li>
<li>Quit the shell with <code class="docutils literal"><span class="pre">\q</span></code></li>
</ol>
</div>
<div class="section" id="create-user-data-directory">
<h3>Create <code class="docutils literal"><span class="pre">user_data</span></code> directory<a class="headerlink" href="#create-user-data-directory" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Navigate to the root directory, <code class="docutils literal"><span class="pre">cd</span> <span class="pre">/</span></code></li>
<li>Create the <code class="docutils literal"><span class="pre">user_data</span></code> directory as root user,
<code class="docutils literal"><span class="pre">sudo</span> <span class="pre">mkdir</span> <span class="pre">user_data</span></code></li>
</ol>
<p>We realize that this is not the best location for the <code class="docutils literal"><span class="pre">user_data</span></code>
directory. In future commits, we&#8217;ll make this option configurable and
perhaps default to a different location.</p>
</div>
<div class="section" id="create-a-virtualenv">
<h3>Create a <code class="docutils literal"><span class="pre">virtualenv</span></code><a class="headerlink" href="#create-a-virtualenv" title="Permalink to this headline">¶</a></h3>
<p>It&#8217;s useful to install python dependencies in a virtual environment so
they are isolated from other python packages in your system. To do this,
use <a class="reference external" href="http://virtualenv.readthedocs.org/en/latest/">virtualenv</a>.</p>
<ol class="arabic simple">
<li>Install virtualenv with pip, <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">virtualenv</span></code></li>
<li>Create a virtual environment (called <code class="docutils literal"><span class="pre">venv</span></code>) within the datahub
directory, <code class="docutils literal"><span class="pre">virtualenv</span> <span class="pre">venv</span></code></li>
<li>Activate the virtual environment, <code class="docutils literal"><span class="pre">source</span> <span class="pre">venv/bin/activate</span></code>.</li>
</ol>
<p>When you are finished with the virtual environment, run <code class="docutils literal"><span class="pre">deactivate</span></code>
to close it.</p>
</div>
<div class="section" id="install-dependencies-with-pip">
<h3>Install dependencies with <code class="docutils literal"><span class="pre">pip</span></code><a class="headerlink" href="#install-dependencies-with-pip" title="Permalink to this headline">¶</a></h3>
<p>Installing the dependencies for DataHub is easy using the
<a class="reference external" href="https://pypi.python.org/pypi/pip">pip</a> package manager.</p>
<ol class="arabic simple">
<li>Install the dependencies with <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code></li>
</ol>
</div>
<div class="section" id="setup-server-and-data-models">
<h3>Setup server and data models<a class="headerlink" href="#setup-server-and-data-models" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Update <code class="docutils literal"><span class="pre">src/settings.py</span></code> with your postgres username and password.</li>
<li>Setup the server environment, <code class="docutils literal"><span class="pre">source</span> <span class="pre">src/setup.sh</span></code> (Please note
that this must be sourced from the root directory.)</li>
<li>Generate a custom SECRET_KEY, <code class="docutils literal"><span class="pre">python</span> <span class="pre">src/scripts/generate_secret_key.py</span></code></li>
<li>Sync with the database, <code class="docutils literal"><span class="pre">python</span> <span class="pre">src/manage.py</span> <span class="pre">migrate</span></code></li>
<li>Migrate the data models, <code class="docutils literal"><span class="pre">python</span> <span class="pre">src/manage.py</span> <span class="pre">migrate</span> <span class="pre">inventory</span></code></li>
</ol>
<p>h1.</p>
</div>
<div class="section" id="run-server">
<h3>Run server<a class="headerlink" href="#run-server" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Run the server, <code class="docutils literal"><span class="pre">python</span> <span class="pre">src/manage.py</span> <span class="pre">runserver</span></code></li>
<li>Navigate to <a class="reference external" href="http://localhost:8000">localhost:8000</a></li>
</ol>
<p><strong>NOTE:</strong> If the server complains that a module is missing, you may need
to <code class="docutils literal"><span class="pre">source</span> <span class="pre">src/setup.sh</span></code> and  <code class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-r</span> <span class="pre">requirements.txt</span></code> again. Then, <code class="docutils literal"><span class="pre">python</span> <span class="pre">src/manage.py</span> <span class="pre">runserver</span></code> and navigate to
<a class="reference external" href="http://localhost:8000">localhost:8000</a></p>
</div>
</div>
<div class="section" id="building-the-documentation">
<h2>Building the Documentation<a class="headerlink" href="#building-the-documentation" title="Permalink to this headline">¶</a></h2>
<p>DataHub uses <a class="reference external" href="http://sphinx-doc.org">Sphinx</a> to build its documentation.</p>
<p>Using the default Vagrant setup:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ vagrant ssh
$ sudo su
$ dh-rebuild-and-collect-static-files
</pre></div>
</div>
<p>Using a local installation of Sphinx (Sphinx is included in <code class="docutils literal"><span class="pre">requirements.txt</span></code>):</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /path/to/datahub
$ make html
</pre></div>
</div>
<p>When submitting a pull request, you must include Sphinx documentation. You can achieve this by adding <code class="docutils literal"><span class="pre">*.rst</span></code> and linking them from other <code class="docutils literal"><span class="pre">*.rst</span></code> files. See <a class="reference external" href="http://sphinx-doc.org/tutorial.html">the Sphinx tutorial</a> for more information.</p>
</div>
</div>


          </div>
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#quickstart-with-vagrant">Quickstart with Vagrant</a><ul>
<li><a class="reference internal" href="#using-non-standard-ports">Using non-standard ports</a></li>
</ul>
</li>
<li><a class="reference internal" href="#manual-installation">Manual Installation</a><ul>
<li><a class="reference internal" href="#clone-the-repo">Clone the repo</a></li>
<li><a class="reference internal" href="#postgresql">PostgreSQL</a></li>
<li><a class="reference internal" href="#create-user-data-directory">Create <code class="docutils literal"><span class="pre">user_data</span></code> directory</a></li>
<li><a class="reference internal" href="#create-a-virtualenv">Create a <code class="docutils literal"><span class="pre">virtualenv</span></code></a></li>
<li><a class="reference internal" href="#install-dependencies-with-pip">Install dependencies with <code class="docutils literal"><span class="pre">pip</span></code></a></li>
<li><a class="reference internal" href="#setup-server-and-data-models">Setup server and data models</a></li>
<li><a class="reference internal" href="#run-server">Run server</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-the-documentation">Building the Documentation</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to DataHub&#8217;s documentation!</a></li>
      <li>Next: <a href="Managing and Testing.html" title="next chapter">Managing and Testing</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/Getting Started.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, MIT Living Lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
      |
      <a href="_sources/Getting Started.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>