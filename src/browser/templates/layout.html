<!DOCTYPE HTML>
<!--
@author: Anant Bhardwaj
@date: Feb 12, 2012

DataHub Template Layout
-->
{% block html %}
<html>
{% endblock %}
<head>
<title>DataHub</title>
<meta charset="utf-8">

<meta name="HandheldFriendly" content="true" />
<meta name="viewport" content="initial-scale=1.0 user-scalable=no" />
<meta name="apple-mobile-web-app-capable" content="yes" />

<link rel="stylesheet" type="text/css" href="/static/css/datahub.css" />
<link rel="stylesheet" type="text/css" href="/static/lib/jquery-ui/css/jquery-ui.css"/>
<link rel="stylesheet" type="text/css" href="/static/lib/jquery-dropdown/css/jquery.dropdown.css"/>
<link rel="stylesheet" type="text/css" href="/static/lib/jquery-terminal/css/jquery.terminal.css" />
<link rel="stylesheet" type="text/css" href="/static/lib/jquery-datatables/css/jquery.dataTables.css" />
<link rel="stylesheet" type="text/css" href="/static/lib/bootstrap/css/bootstrap.min.css">

<script type="text/javascript" src="/static/lib/jquery/jquery.min.js"></script>	
<script type="text/javascript" src="/static/lib/jquery-ui/jquery-ui.js"></script>
<script type="text/javascript" src="/static/lib/jquery-datatables/jquery.dataTables.min.js"></script>	
<script type="text/javascript" src="/static/lib/jquery-datatables/jquery.jeditable.js"></script>	
<script type="text/javascript" src="/static/lib/jquery-dropdown/jquery.dropdown.js"></script>
<script type="text/javascript" src="/static/lib/jquery-mousewheel/jquery.mousewheel-min.js"></script>
<script type="text/javascript" src="/static/lib/jquery-terminal/jquery.terminal-min.js"></script>
<script type="text/javascript" src="/static/lib/bootstrap/js/bootstrap.min.js"></script>

<script type="text/javascript" src="/static/lib/thrift/thrift.js"></script>
<script type="text/javascript" src="/static/lib/thrift/thrift-binary.js"></script>
<script type="text/javascript" src="/static/lib/datahub/datahub_types.js"></script>
<script type="text/javascript" src="/static/lib/datahub/DataHub.js"></script>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" id="logo" href="/">DataHub</a>
  </div>
  
  <div class="navbar-collapse collapse">
    <div class="navbar-right">
      {% block headlink-right %}
      {% if login %}
        <a href="/"><strong>{{ login }}</strong></a>  &nbsp; &nbsp;
        <a href="/console" class="btn navbar-btn" title="SQL Console"><span class="glyphicon glyphicon-tasks"></span></a></li>
        <a href="/logout" class="btn navbar-btn" title="Log Out"><span class="glyphicon glyphicon-log-out"></span></a></li>
      {% else %}
        <a href="/login" title="Log In" class="btn navbar-btn btn-default">Sign In</a>
      {% endif %}
      {% endblock %}
    </div>
  </div>
  </div>
</div>
<div id="page">
<div class="container">
{% block content %}
{% endblock %}

{% block credits %}
{% endblock %}
</div>

<!-- Common Modal Dialogs -->
<div
    class="modal" id="confirm-modal" 
    tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span>
        </button>
        <h4 class="modal-title" id="confirm-modal-title">Confirm</h4>
      </div>
      <div class="modal-body" id="confirm-modal-body">Are you sure?</div>
      <div class="modal-footer">
        <button type="button"
            class="btn btn-primary" id="confirm-modal-operation">OK</button>
        <button type="button"
            class="btn btn-default" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>

<div
    class="modal" id="import-modal" 
    tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">
          <span aria-hidden="true">&times;</span>
          <span class="sr-only">Close</span>
        </button>
        <h4 class="modal-title" id="confirm-modal-title">DataHub Import</h4>
      </div>
      <div class="modal-body" id="confirm-modal-body">
        <form id="frm-import" role="form" method="GET" action="#">
          <input type="hidden" name="file" id="import-file-name" />
          <label for="delemiter">Delemiter</label>
          <select id="import-delemiter" name="delimiter">
            <option value=",">Comma (,)</option>
            <option value="\t">Tabs (\t)</option>
            <option value=":">Colon (:)</option>
            <option value=";">Semi Colon (;)</option>
            <option value="|">Vertical Bar (|)</option>
            <option value=" ">White Space ( )</option>
          </select>          
        </form>
      </div>
      <div class="modal-footer">
        <button type="button"
            class="btn btn-primary" id="import-modal-operation">Import</button>
        <button type="button"
            class="btn btn-default" data-dismiss="modal">Cancel</button>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript">
$(function() {
  function show_modal(
        modal_id, modal_title, modal_body, modal_operation, target_url) {
    
    if (modal_title) {
      $(modal_id + '-title').html(modal_title)
    }

    if (modal_body) {
      $(modal_id + '-body').html(modal_body)
    }
    
    if (modal_operation) {
      $(modal_id + '-operation').html(modal_operation)
    }

    $(modal_id).off('click');
    
    $(modal_id).modal({keyboard: true})
      .on('click', modal_id + '-operation', function (e) {
          window.location.href = window.location.protocol + '//' + window.location.host + target_url
      });
  }

  $('.modal-confirm-dialog').on('click', function(e){
    var modal_id = $(this).attr('target-modal')
    var modal_title = $(this).attr('target-modal-title')
    var modal_body = $(this).attr('target-modal-body')
    var modal_operation = $(this).attr('target-modal-operation')
    var target_url = $(this).attr('target-url')

    show_modal(modal_id, modal_title, modal_body, modal_operation, target_url)
  });

  $('.modal-import-dialog').on('click', function(e){
    var modal_id = $(this).attr('target-modal')
    var target_url = $(this).attr('target-url')
    var target_file = $(this).attr('target-file')

    $(modal_id).off('click');
    
    $(modal_id).modal({keyboard: true})
      .on('click', modal_id + '-operation', function (e) {
        $("#import-file-name").val(target_file)
        $("#frm-import").attr("action", target_url)
        console.log($("#frm-import").attr("action"))
        $("#frm-import").submit()
          
      });
  });
});
</script>

</div>
</body>
</html>
